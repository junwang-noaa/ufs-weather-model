rm -fr INPUT RESTART
if [ $NPX = 97 ]; then
  inputdir=FV3_input_data
elif [ $NPX = 193 ]; then
  inputdir=FV3_input_data192
elif [ $NPX = 385 ]; then
  inputdir=FV3_input_data384
elif [ $NPX = 769 ]; then
  inputdir=FV3_input_data_c768
fi
echo "inputdir=$inputdir,NPX=$NPX"

UNIT_TEST=${UNIT_TEST:-false}
SUFFIX=${RT_SUFFIX}
if [ $WARM_START = .F. ]; then
  mkdir INPUT RESTART
  cp -r @[INPUTDATA_ROOT]/${inputdir}/INPUT_L127/* ./INPUT/.
else
  mkdir INPUT RESTART

  if [[ ${UNIT_TEST} == true ]]; then
    SUFFIX=${BL_SUFFIX}
  fi

  rsync -arv ../control${SUFFIX}/RESTART/ INPUT/
  if [[ $IAU_INC_FILES = 'fv3_increment.nc' ]] || [[ $READ_INCREMENT = '.T.' ]]; then
    #read_inc and iau tests restart from fh=24
    cp ../control${SUFFIX}/RESTART/coupler.res INPUT/.
    cp ../control${SUFFIX}/RESTART/fv_core.res.* INPUT/.
    cp ../control${SUFFIX}/RESTART/fv_srf_wnd.res.* INPUT/.
    cp ../control${SUFFIX}/RESTART/fv_tracer.* INPUT/.
    cp ../control${SUFFIX}/RESTART/phy_data.* INPUT/.
    cp ../control${SUFFIX}/RESTART/sfc_data.* INPUT/.
    cp ../control${SUFFIX}/INPUT/fv3_increment.nc INPUT/.
    cd INPUT
  else
    #restart test start from fh=12
    cp ../control${SUFFIX}/RESTART/20181001.120000.* INPUT/.
    cd INPUT
    for RFILE in 20181001.120000.*; do
      [ -e $RFILE ] || exit 1
      mv $RFILE ${RFILE#20181001.120000.}
    done
  fi
  cp ../../control${SUFFIX}/INPUT/grid_spec.nc .
  cp ../../control${SUFFIX}/INPUT/*_grid.tile*.nc .
  cp ../../control${SUFFIX}/INPUT/oro_data.tile*.nc .
  cd ..

fi

cp    @[INPUTDATA_ROOT]/${inputdir}/INPUT/aerosol.dat .
cp    @[INPUTDATA_ROOT]/${inputdir}/INPUT/co2historicaldata_201*.txt .
cp    @[INPUTDATA_ROOT]/${inputdir}/INPUT/sfc_emissivity_idx.txt .
cp    @[INPUTDATA_ROOT]/${inputdir}/INPUT/solarconstant_noaa_an.txt .
cp    @[INPUTDATA_ROOT]/${inputdir}/global_o3prdlos.f77 .
cp    @[INPUTDATA_ROOT]/${inputdir}/global_h2o_pltc.f77 ./global_h2oprdlos.f77
cp    @[INPUTDATA_ROOT]/${inputdir}/*grb .
cp    @[INPUTDATA_ROOT]/${inputdir}/data_table .
cp    @[INPUTDATA_ROOT]/${inputdir}/diag_table_gfsv16 ./diag_table
cp    @[INPUTDATA_ROOT]/${inputdir}/field_table_gfsv16 ./field_table
cp    @[INPUTDATA_ROOT]/${inputdir}/*configure .

if [ $NEW_DIAGTABLE != '' ]; then
  cp    @[INPUTDATA_ROOT]/${inputdir}/$NEW_DIAGTABLE ./diag_table
fi

if [ $NEW_FIELDTABLE != '' ]; then
  cp    @[INPUTDATA_ROOT]/${inputdir}/$NEW_FIELDTABLE ./field_table
fi

if [ $CPLWAV = .T. ]; then
  cp    @[INPUTDATA_ROOT_WW3]/mod_def.* .
  cp    @[INPUTDATA_ROOT_WW3]/@[SYEAR]@[SMONTH]@[SDAY]/ww3_multi.inp .
  cp    @[INPUTDATA_ROOT_WW3]/@[SYEAR]@[SMONTH]@[SDAY]/rmp_src* .
fi

if [[ $POSTAPP = 'global' ]]; then
    cp ${PATHRT}/parm/post_itag itag
    cp ${PATHRT}/parm/postxconfig-NT.txt postxconfig-NT.txt
    cp ${PATHRT}/parm/postxconfig-NT_FH00.txt postxconfig-NT_FH00.txt
    cp ${PATHRT}/parm/params_grib2_tbl_new params_grib2_tbl_new
fi

if [ $DO_RRTMGP = .T. ]; then
  cp @[INPUTDATA_ROOT]/FV3_input_data_RRTMGP/* .
fi
